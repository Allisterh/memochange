<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Kai Wenger" />

<meta name="date" content="2019-11-08" />

<title>memochange-Tutorial: Change in Mean</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">memochange-Tutorial: Change in Mean</h1>
<h4 class="author">Kai Wenger</h4>
<h4 class="date">2019-11-08</h4>



<p>The <code>memochange</code> package can be used for two things: Checking for a break in persistence and checking for a change in mean. This vignette presents the functions related to a change in mean. This includes the functions <code>CUSUMfixed</code>, <code>CUSUMLM</code>, <code>CUSUM_simple</code>, <code>fixbsupw</code>, <code>snsupwald</code>, <code>snwilcoxon</code>, and <code>wilcoxonLM</code>. Before considering the usage of these functions, a brief literature review elaborates on their connection.</p>
<div id="literature-review" class="section level2">
<h2>Literature Review</h2>
<p>In standard time series models it is usually assumed that the series have a constant mean over time. If this assumption is invalidated, inference and forecasts based on such models are misleading. Therefore, testing for a change in mean is of major importance.</p>
<p>A typical example of a time series that could be subject to a change in mean is the series of average yearly temperatures in New Haven. It is visualized in the following graph.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">utils::<span class="kw">data</span>(nhtemp)
graphics::<span class="kw">plot</span>(nhtemp)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Three standard procedures to test for a change in mean at an unknown point in time are CUSUM tests originally proposed by <span class="citation">Brown, Durbin, and Evans (1975)</span>, Wilcoxon-type rank tests (e.g. <span class="citation">Bauer (1972)</span>), and sup-Wald tests by <span class="citation">Andrews (1993)</span>. Applying the standard CUSUM test, for example, we observe for the above temperature series that the corresponding p-value of the test is smaller than any resonable significance level.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">strucchange::<span class="kw">sctest</span>(strucchange::<span class="kw">efp</span>(nhtemp ~<span class="st"> </span><span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;OLS-CUSUM&quot;</span>))
<span class="co">#&gt; </span>
<span class="co">#&gt;  OLS-based CUSUM test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  strucchange::efp(nhtemp ~ 1, type = &quot;OLS-CUSUM&quot;)</span>
<span class="co">#&gt; S0 = 2.0728, p-value = 0.0003709</span></code></pre></div>
<p>Therefore, it rejects the null hypothesis of a constant mean over time and we conclude that there is a change in mean.</p>
<p>However, all these standard tests suffer from the issue that they cannot be applied under long memory. In a persistent long-memory time series far distant observations are significantly correlated. The degree of persistence is given by the long-memory parameter <span class="math inline">\(d \in [0,0.5)\)</span>. Higher values of <span class="math inline">\(d\)</span> indicate higher persistence of the series. The special case <span class="math inline">\(d=0\)</span> is called short memory where far distant observations are not significantly correlated anymore. The difference between a short-memory and a long-memory time series can be seen easily in the autocorrelation function (acf) of a series, which gives the correlation between observations separated by various time lags.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">T            &lt;-<span class="st"> </span><span class="dv">1000</span>
series_short &lt;-<span class="st"> </span>fracdiff::<span class="kw">fracdiff.sim</span>(<span class="dt">n=</span>T,<span class="dt">d=</span><span class="dv">0</span>)$series
series_long  &lt;-<span class="st"> </span>fracdiff::<span class="kw">fracdiff.sim</span>(<span class="dt">n=</span>T,<span class="dt">d=</span><span class="fl">0.45</span>)$series

graphics::<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
stats::<span class="kw">acf</span>(series_short,<span class="dt">main=</span><span class="st">&quot;short memory&quot;</span>)
stats::<span class="kw">acf</span>(series_long,<span class="dt">main=</span><span class="st">&quot;long memory&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>We observe that the acf of the short-memory time series dies out quickly, while the autocorrelations in the long-memory time series are even at a very large lag (i.e. for far distant observations) high.</p>
<p>The above mentioned standard tests for a change in mean are developed under short memory. <span class="citation">Wright (1998)</span> and <span class="citation">Krämer and Sibbertsen (2002)</span>, among others, found that they asymptotically reject the null hypothesis of a constant mean with probability one under long memory. This can be seen in a simple Monte Carlo simulation for the standard CUSUM test. We simulate <span class="math inline">\(N\)</span> times a short-memory (<span class="math inline">\(d=0\)</span>) and a long-memory (<span class="math inline">\(d=0.45\)</span>) time series of length <span class="math inline">\(T\)</span> without any change in mean, apply the test, and investigate how often the null hypothesis is rejected with a nominal significance level of <span class="math inline">\(5\%\)</span>. Therefore, since we are under the null hypothesis we expect on average <span class="math inline">\(5\%\)</span> rejections.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">410</span>)
T                  &lt;-<span class="st"> </span><span class="dv">500</span>
N                  &lt;-<span class="st"> </span><span class="dv">500</span>
results_short      &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;numeric&quot;</span>,N)
results_long       &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;numeric&quot;</span>,N)
for(i in <span class="dv">1</span>:N)
{
  series_short     &lt;-<span class="st"> </span>fracdiff::<span class="kw">fracdiff.sim</span>(<span class="dt">n=</span>T,<span class="dt">d=</span><span class="dv">0</span>)$series
  series_long      &lt;-<span class="st"> </span>fracdiff::<span class="kw">fracdiff.sim</span>(<span class="dt">n=</span>T,<span class="dt">d=</span><span class="fl">0.45</span>)$series
  results_short[i] &lt;-<span class="st"> </span>strucchange::<span class="kw">sctest</span>(strucchange::<span class="kw">efp</span>(series_short ~<span class="st"> </span><span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;OLS-CUSUM&quot;</span>))$p.value&lt;<span class="fl">0.05</span>
  results_long[i]  &lt;-<span class="st"> </span>strucchange::<span class="kw">sctest</span>(strucchange::<span class="kw">efp</span>(series_long ~<span class="st"> </span><span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;OLS-CUSUM&quot;</span>))$p.value&lt;<span class="fl">0.05</span>
}
<span class="kw">mean</span>(results_short)
<span class="co">#&gt; [1] 0.056</span>
<span class="kw">mean</span>(results_long)
<span class="co">#&gt; [1] 0.992</span></code></pre></div>
<p>Under short memory the test roghly holds its significance level of <span class="math inline">\(5\%\)</span>. However, under long memory the standard CUSUM test nearly always rejects. It cannot be used whenever <span class="math inline">\(d&gt;0\)</span>.</p>
<p>Due to the problems described, a lot of researchers modified standard testing procedures for a change in mean to account for <span class="math inline">\(0&lt;d&lt;0.5\)</span> in recent years. A review is given in <span class="citation">Wenger, Leschinski, and Sibbertsen (2019)</span>. Tests based on the CUSUM testing principle are the CUSUM-LM test by <span class="citation">Horváth and Kokoszka (1997)</span> and <span class="citation">Wang (2008)</span>, the (simple) CUSUM test based on fractionally differenced data by <span class="citation">Wenger, Leschinski, and Sibbertsen (2018)</span>, and the CUSUM fixed bandwidth tests by <span class="citation">Wenger and Leschinski (2019)</span>. Wilcoxon type tests are the Wilcoxon-LM test by <span class="citation">Dehling, Rooch, and Taqqu (2013)</span> and the self-normalized Wilcoxon test by <span class="citation">Betken (2016)</span>. Modified sup-wald tests for a change in mean are the self-normalized sup-Wald test by <span class="citation">Shao (2011)</span> and the fixed-b sup-Wald test by <span class="citation">Iacone, Leybourne, and Taylor (2014)</span>.</p>
<p>The tests can be further divided into more or less three groups depending on how the variance of the mean (long-run variance) that appears in the denominator of all test statistics is estimated. Without going into too many details, the first group (CUSUM-LM and Wilcoxon-LM tests) utilizes the MAC estimator by <span class="citation">Robinson (2005)</span> that consistently estimates the long-run variance under long memory. The second group (self-normalized Wilcoxon and self-normalized sup-Wald tests) applies a self-normalization approach (see <span class="citation">Shao (2010)</span>). A self-normalizer is not a consistent estimate of the long-run variance, but proportional to it, even when <span class="math inline">\(d&gt;0\)</span>. The third group (CUSUM fixed bandwidth and fixed-b sup-Wald tests) uses fixed bandwidth approach (see <span class="citation">Kiefer and Vogelsang (2005)</span> and <span class="citation">Hualde and Iacone (2017)</span>). It is a generalization of the self-normalization approach.</p>
<p><span class="citation">Wenger, Leschinski, and Sibbertsen (2019)</span> observe via simulations that for fractionally integrated White noise time series (which is one class of long-memory time series) the CUSUM testing procedure seems to offer the highest rejection rates under the alternative of a mean shift (i.e. offers the highest power). However, the first group of tests that apply a consistent estimator of the long-run variance (e.g. the CUSUM-LM test) also rejects the null hypothesis of a constant mean too often in a time series that is not subject to a mean shift. In other words these tests are often size distorted. In contrast, the self-normalized and fixed bandwidth tests hold their size in most of the situations. For fractionally integrated heavy tailed time series (which is another class of long-memory time series) it is shown by <span class="citation">Dehling, Rooch, and Taqqu (2013)</span> and <span class="citation">Betken (2016)</span> that Wilcoxon type tests are superior to CUSUM tests.</p>
<p>The simple CUSUM test by <span class="citation">Wenger, Leschinski, and Sibbertsen (2018)</span> is a little bit exceptional in the list of tests implemented. The reason is that instead of modifying the standard CUSUM test it modifies the data the standard test is applied on.</p>
</div>
<div id="usage" class="section level2">
<h2>Usage</h2>
<p>Two examples how to conduct the change-in-mean tests implemented in the <code>memochange</code> package are discussed in the following. The first example is an application of the tests to a real data set. The second example is a small Monte Carlo simulation where the performance of the tests is compared.</p>
<p>First, we consider the log squared returns of the NASDAQ in the time around the global financial crisis (2006-2009). We download the daily stock price series from the FRED data base.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nasdaq=data.table::<span class="kw">fread</span>(<span class="st">&quot;https://fred.stlouisfed.org/graph/fredgraph.csv?bgcolor=%23e1e9f0&amp;chart_type=line&amp;drp=0&amp;fo=open%20sans&amp;graph_bgcolor=%23ffffff&amp;height=450&amp;mode=fred&amp;recession_bars=on&amp;txtcolor=%23444444&amp;ts=12&amp;tts=12&amp;width=1168&amp;nt=0&amp;thu=0&amp;trc=0&amp;show_legend=yes&amp;show_axis_titles=yes&amp;show_tooltip=yes&amp;id=NASDAQCOM&amp;scale=left&amp;cosd=2006-01-01&amp;coed=2009-01-01&amp;line_color=%234572a7&amp;link_values=false&amp;line_style=solid&amp;mark_type=none&amp;mw=3&amp;lw=2&amp;ost=-99999&amp;oet=99999&amp;mma=0&amp;fml=a&amp;fq=Daily&amp;fam=avg&amp;fgst=lin&amp;fgsnd=2009-06-01&amp;line_index=1&amp;transformation=lin&amp;vintage_date=2019-11-04&amp;revision_date=2019-11-04&amp;nd=1971-02-05&quot;</span>)</code></pre></div>
<p>Next calculate the log squared returns as a measure of volatility and plot the series.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nasdaq              &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(nasdaq)
nasdaq[nasdaq==<span class="st">&quot;.&quot;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>
nasdaq              &lt;-<span class="st"> </span>stats::<span class="kw">na.omit</span>(nasdaq)
nasdaq$NASDAQCOM    &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(nasdaq$NASDAQCOM)
nasdaq$DATE=zoo::<span class="kw">as.Date</span>(nasdaq$DATE)
nasdaq_xts=xts::<span class="kw">xts</span>(nasdaq[,-<span class="dv">1</span>],<span class="dt">order.by =</span> nasdaq$DATE)
nasdaq_xts          &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="kw">diff</span>(nasdaq_xts)^<span class="dv">2</span>)[-<span class="dv">1</span>]
graphics::<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))
zoo::<span class="kw">plot.zoo</span>(nasdaq_xts, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Log squared returns&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Log squared returns of the NASDAQ&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>A first visual impression is that the mean seems to increase in the second part of the sample. Furthermore, applying the local Whittle estimator (choosing the bandwidth as T^0.65, which is usual in literature) we observe that there is the potential that the time series possess high persistence (d&gt;0).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">T           &lt;-<span class="st"> </span><span class="kw">length</span>(nasdaq_xts)
x           &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(nasdaq_xts)
d_est       &lt;-<span class="st"> </span>LongMemoryTS::<span class="kw">local.W</span>(x, <span class="dt">m=</span><span class="kw">floor</span>(<span class="dv">1</span>+T^<span class="fl">0.65</span>))$d
<span class="kw">round</span>(d_est,<span class="dv">3</span>)
<span class="co">#&gt; [1] 0.303</span></code></pre></div>
<p>Therefore, as discussed above the standard testing procedures for a change in mean cannot be applied. Instead, one of the functions <code>CUSUM_simple</code>, <code>CUSUMfixed</code>, <code>CUSUMLM</code>, <code>fixbsupw</code>, <code>snsupwald</code>, <code>snwilcoxon</code>, and <code>wilcoxonLM</code> have to be used. The functionality of all tests is similar. They require a univariate numeric vector <code>x</code> as an input variable and yield a matrix of test statistic and critical values as an output variable.</p>
<p>We apply the CUSUM fixed-m type A test of <span class="citation">Wenger and Leschinski (2019)</span> implemented in the function <code>CUSUMfixed</code> as an example. First, the arguments of the function are explained since it nests all arguments of the other implemented functions to test for a change in mean in a persistent time series.</p>
<p>We have to insert the (estimated) long-memory parameter <code>d</code> as a first argument. The critical values of all tests depend on the long-memory parameter, except for the simple CUSUM test. However, also in the function <code>CUSUM_simple</code> the long-memory parameter has to be inserted since it is used to transform the time series the test is applied on.</p>
<p>As a second argument the <code>type</code> of the CUSUM fixed bandwidth function has to be supplied. The user can choose between the CUSUM fixed-b and fixed-m tests of type-A or -B. According to <span class="citation">Wenger and Leschinski (2019)</span> the type-A tests outperform the type-B tests when the break is in the middle of the series while the revearse is true when the break break occurs at the beginning or the end of the series.</p>
<p>In all fixed bandwidth functions (<code>CUSUMfixed</code>, <code>fixbsupw</code>) the bandwidth <code>bandw</code> has to be chosen. The bandwidth determines how many autocovariances for the fixed-<span class="math inline">\(b\)</span> tests and respectively how many periodogram ordinates for the fixed-<span class="math inline">\(M\)</span> tests are included in the estimators of the long-run variance. For the fixed-<span class="math inline">\(b\)</span> tests <span class="math inline">\(b\in(0,1]\)</span> and for the fixed-<span class="math inline">\(M\)</span> tests <span class="math inline">\(M\in[1,T]\)</span>. Since the critical values of all fixed bandwidth tests depend not only on <span class="math inline">\(d\)</span>, but also on the bandwidth, just for a couple of bandwidths critical values are given in the functions. <span class="citation">Wenger and Leschinski (2019)</span> and <span class="citation">Iacone, Leybourne, and Taylor (2014)</span> suggest to use <span class="math inline">\(b=0.1\)</span> and <span class="math inline">\(M=10\)</span>.</p>
<p>The last argument of all tests is <code>tau</code>. It corresponds to the search area <span class="math inline">\([\tau,1-\tau]\)</span> with <span class="math inline">\(\tau \in (0,1)\)</span>, in which the test statistics are calculated. <span class="citation">Andrews (1993)</span> suggests using <span class="math inline">\(\tau_{1}=1-\tau_{2}=0.15\)</span>, which is the default value for <code>tau</code>. Note that critical values of the tests are also dependent on <code>tau</code> and just implemented for the default value.</p>
<p>Executing the test we get the following result.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(memochange)
<span class="kw">CUSUMfixed</span>(x,<span class="dt">d=</span>d_est,<span class="dt">procedure=</span><span class="st">&quot;CUSUMfixedm_typeA&quot;</span>,<span class="dt">bandw=</span><span class="dv">10</span>)
<span class="co">#&gt;           90%           95%           99% Teststatistic </span>
<span class="co">#&gt;         1.499         1.615         1.805         1.931</span></code></pre></div>
<p>The output of all functions is a matrix consisting of the test statistic and critical values for the null hypothesis of a constant mean against the alternative of a change in mean at some unknown point in time. Here, the results suggest that a change in mean has occurred somewhere in the series since the test statistic exceeds the critical value at the one percent level.</p>
<p>To correctly model and forecast the series, the exact location of the break is important. This can be estimated by the <code>breakpoints</code> function from the <code>strucchange</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">BP       &lt;-<span class="st"> </span>strucchange::<span class="kw">breakpoints</span>(x~<span class="dv">1</span>)$breakpoints
BP_index &lt;-<span class="st"> </span>zoo::<span class="kw">index</span>(nasdaq_xts[BP])
BP_index
<span class="co">#&gt; [1] &quot;2007-07-23&quot;</span></code></pre></div>
<p>The function indicates that there is a break in persistence in July, 2007, which roughly corresponds to the start of the world financial crisis. The following plot shows the time series and the estimated means before and after the break</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">T_index  &lt;-<span class="st"> </span>zoo::<span class="kw">index</span>(nasdaq_xts[T])
m1       &lt;-<span class="st"> </span><span class="kw">mean</span>(nasdaq_xts[<span class="dv">1</span>:BP])
m2       &lt;-<span class="st"> </span><span class="kw">mean</span>(nasdaq_xts[(BP<span class="dv">+1</span>):T])
zoo::<span class="kw">plot.zoo</span>(nasdaq_xts, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Log squared returns&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Log squared returns of the NASDAQ&quot;</span>)
graphics::<span class="kw">segments</span>(<span class="dv">0</span>,m1,BP_index,m1,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>)
graphics::<span class="kw">segments</span>((BP_index<span class="dv">+1</span>),m2,T_index,m2,<span class="dt">col=</span><span class="dv">2</span>,<span class="dt">lwd=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>As a second example, we compare the performance of two of the implemented tests via a Monte Carlo simulation study. Under the null hypothesis (i.e. if there is no shift in the series) the tests should reject in <span class="math inline">\(\alpha \%\)</span> of cases. Here, <span class="math inline">\(\alpha\)</span> is the significance level and we choose <span class="math inline">\(\alpha=0.05\)</span>. Under the alternative (i.e. if there is a shift in the series), the tests should reject in most of the cases (at best: always). When the length of the time series increases, the rejection rates should increase.</p>
<p>We simulate fractionally integrated White noise time series (with and without breaks) using the <code>fracdiff.sim</code> function from the <code>fracdiff</code> package. To estimate the memory parameter we apply the local Whittle estimator by <span class="citation">Robinson (1995)</span> using the <code>local.W</code> function from the <code>LongMemoryTS</code> package. The setup is very similar to the published paper by <span class="citation">Wenger and Leschinski (2019)</span>. The simulation can be extended by all other change-in-mean tests that are implemented in the <code>memochange</code> package, which is not been done here to save computing time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
test_func&lt;-function(T,d)
{
  <span class="co"># Simulate a fractionally integrated (long-memory) time series of </span>
  <span class="co"># length T with memory d that is not subject to a shift.</span>
  tseries     &lt;-<span class="st"> </span>fracdiff::<span class="kw">fracdiff.sim</span>(<span class="dt">n=</span>T,<span class="dt">d=</span>d)$series

  <span class="co"># Simulate a fractionally integrated (long-memory) time series of </span>
  <span class="co"># length T with memory d that is subject to a shift in the middle of</span>
  <span class="co"># the sample of magnitude 2.  </span>
  changep     &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,T/<span class="dv">2</span>),<span class="kw">rep</span>(<span class="dv">2</span>,T/<span class="dv">2</span>))
  tseries2    &lt;-<span class="st"> </span>tseries+changep

  <span class="co"># Estimate the long-memory parameter of both series using the suggested bandwidth. </span>
  d_est       &lt;-<span class="st"> </span>LongMemoryTS::<span class="kw">local.W</span>(tseries, <span class="dt">m=</span><span class="kw">floor</span>(<span class="dv">1</span>+T^<span class="fl">0.65</span>))$d
  d_est2      &lt;-<span class="st"> </span>LongMemoryTS::<span class="kw">local.W</span>(tseries2, <span class="dt">m=</span><span class="kw">floor</span>(<span class="dv">1</span>+T^<span class="fl">0.65</span>))$d
  
  <span class="co"># Apply both functions on both time series. Arguments are chosen according to </span>
  <span class="co"># Wenger, Leschinski (2019) who propose these tests.</span>
  typeAsize   &lt;-<span class="st"> </span><span class="kw">CUSUMfixed</span>(tseries,<span class="dt">d=</span>d_est,<span class="dt">procedure=</span><span class="st">&quot;CUSUMfixedm_typeA&quot;</span>,<span class="dt">bandw=</span><span class="dv">10</span>)
  typeBsize   &lt;-<span class="st"> </span><span class="kw">CUSUMfixed</span>(tseries,<span class="dt">d=</span>d_est,<span class="dt">procedure=</span><span class="st">&quot;CUSUMfixedm_typeB&quot;</span>,<span class="dt">bandw=</span><span class="dv">10</span>)
  typeApower  &lt;-<span class="st"> </span><span class="kw">CUSUMfixed</span>(tseries2,<span class="dt">d=</span>d_est2,<span class="dt">procedure=</span><span class="st">&quot;CUSUMfixedm_typeA&quot;</span>,<span class="dt">bandw=</span><span class="dv">10</span>)
  typeBpower  &lt;-<span class="st"> </span><span class="kw">CUSUMfixed</span>(tseries2,<span class="dt">d=</span>d_est2,<span class="dt">procedure=</span><span class="st">&quot;CUSUMfixedm_typeB&quot;</span>,<span class="dt">bandw=</span><span class="dv">10</span>)
  
  <span class="co"># Save if the tests reject at the 5% significance level.</span>
  decAsize    &lt;-<span class="st"> </span>typeAsize[<span class="st">&quot;Teststatistic&quot;</span>] &gt;<span class="st"> </span>typeAsize[<span class="st">&quot;95%&quot;</span>]
  decBsize    &lt;-<span class="st"> </span>typeBsize[<span class="st">&quot;Teststatistic&quot;</span>] &gt;<span class="st"> </span>typeBsize[<span class="st">&quot;95%&quot;</span>]
  decApower   &lt;-<span class="st"> </span>typeApower[<span class="st">&quot;Teststatistic&quot;</span>] &gt;<span class="st"> </span>typeApower[<span class="st">&quot;95%&quot;</span>]
  decBpower   &lt;-<span class="st"> </span>typeBpower[<span class="st">&quot;Teststatistic&quot;</span>] &gt;<span class="st"> </span>typeBpower[<span class="st">&quot;95%&quot;</span>]
  
  <span class="kw">return</span>(<span class="kw">c</span>(decAsize,decBsize,decApower,decBpower))
}</code></pre></div>
<p>In the next step the Monte Carlo simulation (<span class="math inline">\(N=500\)</span> replications) is executed. The parameters we use for the simulated fractionally integrated White noise time series are series length <span class="math inline">\(T=[50,100]\)</span> and long-memory parameters <span class="math inline">\(d=[0.1,0.2]\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">410</span>)
<span class="co"># Parameter setting considered</span>
T_grid              &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">50</span>,<span class="dv">100</span>)
d_grid              &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>)
N                   &lt;-<span class="st"> </span><span class="dv">500</span>

<span class="co"># Generate array to save the results </span>
resultmat           &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="ot">NA</span>, <span class="dt">dim=</span><span class="kw">c</span>(<span class="kw">length</span>(T_grid),<span class="kw">length</span>(d_grid),<span class="dv">4</span>))
<span class="kw">dimnames</span>(resultmat) &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">paste</span>(<span class="st">&quot;T=&quot;</span>,T_grid,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>),<span class="kw">paste</span>(<span class="st">&quot;d=&quot;</span>,d_grid,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>),
                            <span class="kw">paste</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;type-A&quot;</span>,<span class="st">&quot;type-B&quot;</span>),<span class="dv">2</span>),<span class="kw">c</span>(<span class="st">&quot;size&quot;</span>,<span class="st">&quot;size&quot;</span>,<span class="st">&quot;power&quot;</span>,<span class="st">&quot;power&quot;</span>),<span class="dt">sep=</span><span class="st">&quot; &quot;</span>))

<span class="co"># Monte Carlo simulation</span>
for(TTT in <span class="dv">1</span>:<span class="kw">length</span>(T_grid))
{
  T &lt;-<span class="st"> </span>T_grid[TTT]
  for(ddd in <span class="dv">1</span>:<span class="kw">length</span>(d_grid))
  {
    d                 &lt;-<span class="st"> </span>d_grid[ddd]
    result_vec        &lt;-<span class="st"> </span><span class="dv">0</span>
    for(i in <span class="dv">1</span>:N)
    {
    result_vec        &lt;-<span class="st"> </span>result_vec+<span class="kw">test_func</span>(T,d)
    }
  resultmat[TTT,ddd,] &lt;-<span class="st"> </span>result_vec/N
  }
}
<span class="co"># Results</span>
resultmat
<span class="co">#&gt; , , type-A size</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       d=0.1 d=0.2</span>
<span class="co">#&gt; T=50  0.020 0.032</span>
<span class="co">#&gt; T=100 0.026 0.046</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , type-B size</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       d=0.1 d=0.2</span>
<span class="co">#&gt; T=50  0.016 0.028</span>
<span class="co">#&gt; T=100 0.036 0.046</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , type-A power</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       d=0.1 d=0.2</span>
<span class="co">#&gt; T=50   0.86 0.824</span>
<span class="co">#&gt; T=100  1.00 0.960</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , type-B power</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       d=0.1 d=0.2</span>
<span class="co">#&gt; T=50  0.830 0.770</span>
<span class="co">#&gt; T=100 0.998 0.938</span></code></pre></div>
<p>We observe that both tests do not exceed <span class="math inline">\(\alpha=5\%\)</span> rejections when no break occured in the long-memory time series (first two tables). Furthermore, the type-A test rejects more often than the type-B test the null hypothesis when a shift occured. Therefore, this small Monte Carlo simulation leads to the same conclusion as the paper of <span class="citation">Wenger and Leschinski (2019)</span>, i.e. that the type-A test outperforms the type-B test for fractionally integrated White noise time series when the break is in the middle of the series.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-andrews1993tests">
<p>Andrews, Donald WK. 1993. “Tests for Parameter Instability and Structural Change with Unknown Change Point.” <em>Econometrica</em>. JSTOR, 821–56. doi:<a href="https://doi.org/10.2307/2951764">10.2307/2951764</a>.</p>
</div>
<div id="ref-bauer1972constructing">
<p>Bauer, David F. 1972. “Constructing Confidence Sets Using Rank Statistics.” <em>Journal of the American Statistical Association</em> 67 (339). Taylor &amp; Francis: 687–90.</p>
</div>
<div id="ref-betken2016testing">
<p>Betken, Annika. 2016. “Testing for Change-Points in Long-Range Dependent Time Series by Means of a Self-Normalized Wilcoxon Test.” <em>Journal of Time Series Analysis</em> 37 (6). Wiley Online Library: 785–809. doi:<a href="https://doi.org/10.1111/jtsa.12187">10.1111/jtsa.12187</a>.</p>
</div>
<div id="ref-brown1975techniques">
<p>Brown, Robert L, James Durbin, and James M Evans. 1975. “Techniques for Testing the Constancy of Regression Relationships over Time.” <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>. JSTOR, 149–92.</p>
</div>
<div id="ref-dehling2013non">
<p>Dehling, Herold, Aeneas Rooch, and Murad S Taqqu. 2013. “Non-Parametric Change-Point Tests for Long-Range Dependent Data.” <em>Scandinavian Journal of Statistics</em> 40 (1). Wiley Online Library: 153–73. doi:<a href="https://doi.org/10.1111/j.1467-9469.2012.00799.x">10.1111/j.1467-9469.2012.00799.x</a>.</p>
</div>
<div id="ref-horvath1997effect">
<p>Horváth, Lajos, and Piotr Kokoszka. 1997. “The Effect of Long-Range Dependence on Change-Point Estimators.” <em>Journal of Statistical Planning and Inference</em> 64 (1). Elsevier: 57–81. doi:<a href="https://doi.org/10.1016/s0378-3758(96)00208-x">10.1016/s0378-3758(96)00208-x</a>.</p>
</div>
<div id="ref-hualde2017fixed">
<p>Hualde, Javier, and Fabrizio Iacone. 2017. “Fixed Bandwidth Asymptotics for the Studentized Mean of Fractionally Integrated Processes.” <em>Economics Letters</em> 150. Elsevier: 39–43. doi:<a href="https://doi.org/10.1016/j.econlet.2016.10.014">10.1016/j.econlet.2016.10.014</a>.</p>
</div>
<div id="ref-iacone2014fixed">
<p>Iacone, Fabrizio, Stephen Leybourne, and Robert AM Taylor. 2014. “A Fixed-B Test for a Break in Level at an Unknown Time Under Fractional Integration.” <em>Journal of Time Series Analysis</em> 35 (1). Wiley Online Library: 40–54. doi:<a href="https://doi.org/10.1111/jtsa.12049">10.1111/jtsa.12049</a>.</p>
</div>
<div id="ref-kiefer2005new">
<p>Kiefer, Nicholas M, and Timothy J Vogelsang. 2005. “A New Asymptotic Theory for Heteroskedasticity-Autocorrelation Robust Tests.” <em>Econometric Theory</em>. JSTOR, 1130–64. doi:<a href="https://doi.org/10.1017/s0266466605050565">10.1017/s0266466605050565</a>.</p>
</div>
<div id="ref-kramer2000testing">
<p>Krämer, Walter, and Philipp Sibbertsen. 2002. “Testing for Structural Changes in the Presence of Long Memory.” <em>International Journal of Business and Economics</em> 1 (3): 235–42. <a href="http://hdl.handle.net/10419/77279" class="uri">http://hdl.handle.net/10419/77279</a>.</p>
</div>
<div id="ref-robinson1995gaussian">
<p>Robinson, Peter M. 1995. “Gaussian Semiparametric Estimation of Long Range Dependence.” <em>The Annals of Statistics</em> 23 (5). Institute of Mathematical Statistics: 1630–61. doi:<a href="https://doi.org/10.1214/aos/1176324317">10.1214/aos/1176324317</a>.</p>
</div>
<div id="ref-robinson2005robust">
<p>———. 2005. “Robust Covariance Matrix Estimation: HAC Estimates with Long Memory/Antipersistence Correction.” <em>Econometric Theory</em> 21 (01). Cambridge Univ Press: 171–80.</p>
</div>
<div id="ref-shao2010self">
<p>Shao, Xiaofeng. 2010. “A Self-Normalized Approach to Confidence Interval Construction in Time Series.” <em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em> 72 (3). Wiley Online Library: 343–66.</p>
</div>
<div id="ref-shao2011simple">
<p>———. 2011. “A Simple Test of Changes in Mean in the Possible Presence of Long-Range Dependence.” <em>Journal of Time Series Analysis</em> 32 (6). Wiley Online Library: 598–606. doi:<a href="https://doi.org/10.1111/j.1467-9892.2010.00717.x">10.1111/j.1467-9892.2010.00717.x</a>.</p>
</div>
<div id="ref-wang2008change">
<p>Wang, Lihong. 2008. “Change-in-Mean Problem for Long Memory Time Series Models with Applications.” <em>Journal of Statistical Computation and Simulation</em> 78 (7). Taylor &amp; Francis: 653–68. doi:<a href="https://doi.org/10.1080/00949650701216604">10.1080/00949650701216604</a>.</p>
</div>
<div id="ref-wenger2019fixed">
<p>Wenger, Kai, and Christian Leschinski. 2019. “Fixed-Bandwidth Cusum Tests Under Long Memory.” <em>Econometrics and Statistics</em>. Elsevier. doi:<a href="https://doi.org/10.1016/j.ecosta.2019.08.001">10.1016/j.ecosta.2019.08.001</a>.</p>
</div>
<div id="ref-wenger2018simple">
<p>Wenger, Kai, Christian Leschinski, and Philipp Sibbertsen. 2018. “A Simple Test on Structural Change in Long-Memory Time Series.” <em>Economics Letters</em> 163. Elsevier: 90–94. doi:<a href="https://doi.org/10.1016/j.econlet.2017.12.007">10.1016/j.econlet.2017.12.007</a>.</p>
</div>
<div id="ref-wenger2019change">
<p>———. 2019. “Change-in-Mean Tests in Long-Memory Time Series: A Review of Recent Developments.” <em>AStA Advances in Statistical Analysis</em> 103 (2). Springer: 237–56. doi:<a href="https://doi.org/10.1007/s10182-018-0328-5">10.1007/s10182-018-0328-5</a>.</p>
</div>
<div id="ref-wright1998testing">
<p>Wright, Jonathan H. 1998. “Testing for a Structural Break at Unknown Date with Long-Memory Disturbances.” <em>Journal of Time Series Analysis</em> 19 (3). Wiley Online Library: 369–76. doi:<a href="https://doi.org/10.1111/1467-9892.00097">10.1111/1467-9892.00097</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
