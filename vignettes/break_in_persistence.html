<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Janis Becker" />

<meta name="date" content="2019-11-04" />

<title>memochange-Tutorial: Break in Persistence</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">memochange-Tutorial: Break in Persistence</h1>
<h4 class="author">Janis Becker</h4>
<h4 class="date">2019-11-04</h4>



<p>The <code>memochange</code> package can be used for two things: Checking for a break in persistence and checking for a change in mean. This vignette presents the functions related to a break in persistence. This includes <code>BP_estim</code>, <code>cusum_test</code>, <code>LBI_test</code>, <code>LKSN_test</code>, <code>MR_test</code>, <code>ratio_test</code>, and <code>pb_sim</code>. Before considering the usage of these functions, a brief literature review elaborates on their connection.</p>
<div id="literature-review" class="section level2">
<h2>Literature Review</h2>
<p>The degree of memory is an important determinant of the characteristics of a time series. For an <span class="math inline">\(I(0)\)</span>, or short-memory, process (e.g., AR(1) or ARMA(1,1)), the impact of shocks is short-lived and dies out quickly. On the other hand, for an <span class="math inline">\(I(1)\)</span>, or difference-stationary, process such as the random walk, shocks persist infinitely. Thus, any change in a variable will have an impact on all future realizations. For an <span class="math inline">\(I(d)\)</span>, or long-memory, process with <span class="math inline">\(0&lt;d&lt;1\)</span>, shocks neither die out quickly nor persist infinitely, but have a hyperbolically decaying impact. In this case, the current value of a variable depends on past shocks, but the less so the further these shocks are past.</p>
<p>There are plenty of procedures to determine the memory of a series (see <span class="citation">Robinson and others (1995)</span>, <span class="citation">Shimotsu (2010)</span>, among others). However, there is also the possibility that series exhibit a structural change in memory, often referred to as a change in persistence. Starting with <span class="citation">J.-Y. Kim (2000)</span> various procedures have been proposed to detect these changes and consistently estimate the change point. <span class="citation">Busetti and Taylor (2004)</span> and <span class="citation">Leybourne and Taylor (2004)</span> suggest approaches for testing the null of constant I(0) behaviour of the series against the alternative that a change from either <span class="math inline">\(I(0)\)</span> to <span class="math inline">\(I(1)\)</span> or <span class="math inline">\(I(1)\)</span> to <span class="math inline">\(I(0)\)</span> occurred. However, both approaches show serious distortions if neither the null nor the alternative is true, i.e. the series is constant <span class="math inline">\(I(1)\)</span>. In this case the procedures by <span class="citation">Leybourne et al. (2003)</span> and <span class="citation">Leybourne, Taylor, and Kim (2007)</span> can be applied as they have the same alternative, but assume constant <span class="math inline">\(I(1)\)</span> behaviour under the null. Again, the procedures exhibit distortions when neither the null nor the alternative is true. To remedy this issue, <span class="citation">Harvey, Leybourne, and Taylor (2006)</span> suggest an approach that entails the same critical values for constant <span class="math inline">\(I(0)\)</span> and constant <span class="math inline">\(I(1)\)</span> behavior. Consequently, it accommodates both, constant <span class="math inline">\(I(0)\)</span> and constant <span class="math inline">\(I(1)\)</span> behavior under the null.</p>
<p>While this earlier work focussed on the <span class="math inline">\(I(0)/I(1)\)</span> framework, more recent approaches are able to detect changes from <span class="math inline">\(I(d_1)\)</span> to <span class="math inline">\(I(d_2)\)</span> where <span class="math inline">\(d_1\)</span> and <span class="math inline">\(d_2\)</span> are allowed to be non-integers. <span class="citation">Sibbertsen and Kruse (2009)</span> extend the approach of <span class="citation">Leybourne, Taylor, and Kim (2007)</span> such that the testing procedure consistently detects changes from <span class="math inline">\(0 \leq d_1&lt;1/2\)</span> to <span class="math inline">\(1/2&lt;d_2&lt;3/2\)</span> and vice versa. Under the null the test assumes constant <span class="math inline">\(I(d)\)</span> behavior with <span class="math inline">\(0 \leq d &lt;3/2\)</span>. The approach suggested by <span class="citation">Martins and Rodrigues (2014)</span> is even able to identify changes from <span class="math inline">\(-1/2&lt;d_1&lt;2\)</span> to <span class="math inline">\(-1/2&lt;d_2&lt;2\)</span> with <span class="math inline">\(d_1 \neq d_2\)</span>. Here, under the null the test assumes constant <span class="math inline">\(I(d)\)</span> behavior with <span class="math inline">\(-1/2&lt;d&lt;2\)</span>.</p>
<p>Examples for series that potentially exhibit breaks in persistence are macroeconomic and financial time series such as inflation rates, trading volume, interest rates, volatilities and so on. For these series it is therefore strongly recommended to investigate the possibility of a break in persistence before modeling and forecasting the series.</p>
</div>
<div id="usage" class="section level2">
<h2>Usage</h2>
<p>The <code>memochange</code> package contains all procedure mentioned above to identify whether a time series exhibits a break in persistence mentioned above. Additionally, several estimators are implemented which consistently estimate the point at which the series exhibits a break in persistence and the order of integration in the two regimes. We will now show how the usage of the implemented procedures while investigating the price of crude oil.</p>
<p>First, we download the monthly price series from the FRED data base.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">oil=data.table::<span class="kw">fread</span>(<span class="st">&quot;https://fred.stlouisfed.org/graph/fredgraph.csv?bgcolor=%23e1e9f0&amp;chart_type=line&amp;drp=0&amp;fo=open%20sans&amp;graph_bgcolor=%23ffffff&amp;height=450&amp;mode=fred&amp;recession_bars=on&amp;txtcolor=%23444444&amp;ts=12&amp;tts=12&amp;width=1168&amp;nt=0&amp;thu=0&amp;trc=0&amp;show_legend=yes&amp;show_axis_titles=yes&amp;show_tooltip=yes&amp;id=MCOILWTICO&amp;scale=left&amp;cosd=1986-01-01&amp;coed=2019-08-01&amp;line_color=%234572a7&amp;link_values=false&amp;line_style=solid&amp;mark_type=none&amp;mw=3&amp;lw=2&amp;ost=-99999&amp;oet=99999&amp;mma=0&amp;fml=a&amp;fq=Monthly&amp;fam=avg&amp;fgst=lin&amp;fgsnd=2009-06-01&amp;line_index=1&amp;transformation=lin&amp;vintage_date=2019-09-23&amp;revision_date=2019-09-23&amp;nd=1986-01-01&quot;</span>)</code></pre></div>
<p>To get a first visual impression, we plot the series.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">oil=<span class="kw">as.data.frame</span>(oil)
oil$DATE=zoo::<span class="kw">as.Date</span>(oil$DATE)
oil_xts=xts::<span class="kw">xts</span>(oil[,-<span class="dv">1</span>],<span class="dt">order.by =</span> oil$DATE)
zoo::<span class="kw">plot.zoo</span>(oil_xts, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Price&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Crude Oil Price: West Texas Intermediate&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>From the plot we observe that the series seems to be more variable in its second part from year 2000 onwards. This is first evidence that a change in persistence has occurred. We can test this hypothesis using the functions <code>cusum_test</code> (<span class="citation">Leybourne, Taylor, and Kim (2007)</span>, <span class="citation">Sibbertsen and Kruse (2009)</span>) <code>LBI_test</code> (<span class="citation">Busetti and Taylor (2004)</span>), <code>LKSN_test</code> (<span class="citation">Leybourne et al. (2003)</span>), <code>MR_test</code> (<span class="citation">Martins and Rodrigues (2014)</span>) , and <code>ratio_test</code> (<span class="citation">Busetti and Taylor (2004)</span>, <span class="citation">Leybourne and Taylor (2004)</span>, <span class="citation">Harvey, Leybourne, and Taylor (2006)</span>). In this vignette we use the ratio and MR test since these are the empirically most often applied ones. The functionality of the other tests is similar. They all require a univariate numeric vector <code>x</code> as an input variable and yield a matrix of test statistic and critical values as an output variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(memochange)
x &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(oil[,<span class="dv">2</span>])</code></pre></div>
<p>As a starting point the default version of the ratio test is applied.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ratio_test</span>(x)
<span class="co">#&gt;                                        90%    95%    99% Teststatistic</span>
<span class="co">#&gt; Against change from I(0) to I(1)    3.5148 4.6096 7.5536    225.943543</span>
<span class="co">#&gt; Against change from I(1) to I(0)    3.5588 4.6144 7.5304      1.170217</span>
<span class="co">#&gt; Against change in unknown direction 4.6144 5.7948 9.0840    225.943543</span></code></pre></div>
<p>This yields a matrix that gives test statistic and critical values for the null of constant <span class="math inline">\(I(0)\)</span> against a change from <span class="math inline">\(I(0)\)</span> to <span class="math inline">\(I(1)\)</span> or vice versa. Furthermore, the statistics for a change in an unknown direction are included as well. This accounts for the fact that we perform two tests facing a multiple testing problem. The results suggest that a change from <span class="math inline">\(I(0)\)</span> to <span class="math inline">\(I(1)\)</span> has occurred somewhere in the series since the test statistic exceeds the critical value at the one percent level. In addition, this value is also significant when accounting for the multiple testing problem. Consequently, the default version of the ratio test suggests a break in persistence.</p>
<p>We can modify this default version by choosing the arguments <code>trend</code>, <code>tau</code>, <code>statistic</code>, <code>type</code>, <code>m</code>, <code>z</code>, <code>simu</code>, and <code>M</code> (see the help page of the ratio test for details). The plot does not indicate a linear trend so that it seems unreasonable to change the trend argument. Also, the plot suggests that the break is rather in the middle of the series than at the beginning or the end so that changing <code>tau</code> seems unnecessary as well. The type of test statistic calculated can be easily changed using the statistic argument. However, simulation results indicate mean, max, and exp statistics to deliver qualitatively similar results.</p>
<p>Something that is of more importance is the type of test performed. The default version considers the approach by Busetti and Taylor (2004). In case of a constant <span class="math inline">\(I(1)\)</span> process this test often spuriously identifies a break in persistence. Harvey, Leybourne and Taylor (2006) account for this issue by adjusting the test statistic such that its critical values are the same under constant <span class="math inline">\(I(0)\)</span> and constant <span class="math inline">\(I(1)\)</span>. We can calculate their test statistic by setting <code>type=&quot;HLT&quot;</code>. For this purpose, we need to state the number of polynomials <code>z</code> used in their test statistic. The default value is 9 as suggested by Harvey, Leybourne and Taylor (2006). Choosing another value is only sensible for very large data sets (number of obs. &gt; 10000) where the test statistic cannot be calculated due to computational singularity. In this case decreasing <code>z</code> can allow the test statistic to be calculated. This invalidates the critical values so that we would have to simulate them by setting <code>simu=1</code>. However, as our data set is rather small we can stick with the default of <code>z=9</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ratio_test</span>(x, <span class="dt">type=</span><span class="st">&quot;HLT&quot;</span>)
<span class="co">#&gt;                                        90%    95%    99% Teststatistic 90%</span>
<span class="co">#&gt; Against change from I(0) to I(1)    3.5148 4.6096 7.5536        58.9078204</span>
<span class="co">#&gt; Against change from I(1) to I(0)    3.5588 4.6144 7.5304         0.3085495</span>
<span class="co">#&gt; Against change in unknown direction 4.6144 5.7948 9.0840        44.2171379</span>
<span class="co">#&gt;                                     Teststatistic 95% Teststatistic 99%</span>
<span class="co">#&gt; Against change from I(0) to I(1)           43.4772689        25.3369507</span>
<span class="co">#&gt; Against change from I(1) to I(0)            0.2290113         0.1290305</span>
<span class="co">#&gt; Against change in unknown direction        34.1367566        20.0058559</span></code></pre></div>
<p>Again the test results suggests that there is a break from <span class="math inline">\(I(0)\)</span> to <span class="math inline">\(I(1)\)</span>. Consequently, it is not a constant <span class="math inline">\(I(1)\)</span> process that led to a spurious rejection of the test by Busetti and Taylor (2004).</p>
<p>Another test for a change in persistence is that by Martins and Rodrigues (2014). This is more general as it is not restricted to the <span class="math inline">\(I(0)/I(1)\)</span> framework, but can identify changes from <span class="math inline">\(I(d_1)\)</span> to <span class="math inline">\(I(d_2)\)</span> with <span class="math inline">\(d_1 \neq d_2\)</span> and <span class="math inline">\(-1/2&lt;d_1,d_2&lt;2\)</span>. The default version is applied by</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">MR_test</span>(x)
<span class="co">#&gt;                                           90%       95%       99%</span>
<span class="co">#&gt; Against increase in memory          -1.638729 -1.925646 -2.503650</span>
<span class="co">#&gt; Against decrease in memory          -1.653875 -1.953697 -2.509242</span>
<span class="co">#&gt; Against change in unknown direction -1.937915 -2.210129 -2.726981</span>
<span class="co">#&gt;                                     Teststatistic</span>
<span class="co">#&gt; Against increase in memory              -3.300664</span>
<span class="co">#&gt; Against decrease in memory              -1.629719</span>
<span class="co">#&gt; Against change in unknown direction     -3.300664</span></code></pre></div>
<p>Again, the function returns a matrix consisting of test statistic and critical values. Here, the alternative of the test is an increase respectively a decrease in memory. In line with the results of the ratio test, the approach by Martins and Rodrigues (2014) suggests that the series exhibits an increase in memory, i.e. that the memory of the series increases from <span class="math inline">\(d_1\)</span> to <span class="math inline">\(d_2\)</span> with <span class="math inline">\(d_1&lt;d_2\)</span> at some point in time. Again, this also holds if we consider the critical values that account for the multiple testing problem.</p>
<p>Similar to the ratio test and all other tests against a change in persistence in the <code>memochange</code> package, the MR test also has the same arguments <code>trend</code>, <code>tau</code>, <code>simu</code>, and <code>M</code>. Furthermore, we can choose again the type of test statistic. This time we can decide whether to use the squared t-statistic or the standard t-statistic.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">MR_test</span>(x, <span class="dt">statistic=</span><span class="st">&quot;standard&quot;</span>)
<span class="co">#&gt;                                           90%       95%       99%</span>
<span class="co">#&gt; Against increase in memory          -1.638729 -1.925646 -2.503650</span>
<span class="co">#&gt; Against decrease in memory          -1.653875 -1.953697 -2.509242</span>
<span class="co">#&gt; Against change in unknown direction -1.937915 -2.210129 -2.726981</span>
<span class="co">#&gt;                                     Teststatistic</span>
<span class="co">#&gt; Against increase in memory              -3.300664</span>
<span class="co">#&gt; Against decrease in memory              -1.629719</span>
<span class="co">#&gt; Against change in unknown direction     -3.300664</span></code></pre></div>
<p>As for the ratio test, changing the type of statistic has a rather small effect on the empirical performance of the test.</p>
<p>If we believe that the underlying process exhibits additional short run components, we can account for these by setting <code>serial=TRUE</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">MR_test</span>(x, <span class="dt">serial=</span><span class="ot">TRUE</span>)
<span class="co">#&gt;                                           90%       95%       99%</span>
<span class="co">#&gt; Against increase in memory          -1.638729 -1.925646 -2.503650</span>
<span class="co">#&gt; Against decrease in memory          -1.653875 -1.953697 -2.509242</span>
<span class="co">#&gt; Against change in unknown direction -1.937915 -2.210129 -2.726981</span>
<span class="co">#&gt;                                     Teststatistic</span>
<span class="co">#&gt; Against increase in memory              -3.283153</span>
<span class="co">#&gt; Against decrease in memory              -2.679188</span>
<span class="co">#&gt; Against change in unknown direction     -3.283153</span></code></pre></div>
<p>While the test statistic changes, the conclusion remains the same.</p>
<p>All tests indicate that the oil price series exhibits an increase in memory over time. To correctly model and forecast the series, the exact location of the break is important. This can be estimated by the <code>BP_estim</code> function. It is important for the function that the direction of the change is correctly specified. In our case, an increase in memory has occurred so that we set <code>direction=&quot;01&quot;</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">BP_estim</span>(x, <span class="dt">direction=</span><span class="st">&quot;01&quot;</span>)
<span class="co">#&gt; $Breakpoint</span>
<span class="co">#&gt; [1] 151</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $d_1</span>
<span class="co">#&gt; [1] 0.855238</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_1</span>
<span class="co">#&gt; [1] 0.129834</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $d_2</span>
<span class="co">#&gt; [1] 1.034389</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_2</span>
<span class="co">#&gt; [1] 0.1468516</span></code></pre></div>
<p>This yields a list stating the location of the break (observation 151), semiparametric estimates of the order of integration in the two regimes (0.86 and 1.03) as well as the standard deviations of these estimates (0.13 and 0.15).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">oil$DATE[<span class="dv">151</span>]
<span class="co">#&gt; [1] &quot;1998-07-01&quot;</span></code></pre></div>
<p>Consequently, the function indicates that there is a break in persistence in July, 1998. This means that from the beginning of the sample until June 1998 the series is integrated with an order of 0.85 and from July 1998 on the order of integration increased to 1.03.</p>
<p>As before, the function allows for various types of break point estimators. Instead of the default estimator of Busetti and Taylor (2004), one can also rely on the estimator of Leybourne, Kim, and Taylor (2007) by setting <code>type=&quot;LKT&quot;</code>. This estimator relies on estimates of the long-run variance. Therefore, it is also needed that <code>m</code> is chosen, which determines how many covariances are used when estimating the long-run variance. Leybourne, Kim, and Taylor (2007) suggest <code>m=0</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">BP_estim</span>(x, <span class="dt">direction=</span><span class="st">&quot;01&quot;</span>, <span class="dt">type=</span><span class="st">&quot;LKT&quot;</span>, <span class="dt">m=</span><span class="dv">0</span>)
<span class="co">#&gt; $Breakpoint</span>
<span class="co">#&gt; [1] 148</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $d_1</span>
<span class="co">#&gt; [1] 0.7654911</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_1</span>
<span class="co">#&gt; [1] 0.1259972</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $d_2</span>
<span class="co">#&gt; [1] 0.9672149</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_2</span>
<span class="co">#&gt; [1] 0.1196673</span></code></pre></div>
<p>This yields a similar result with the break point lying in the year 1998 and d increasing from approximately 0.8 to approximately 1.</p>
<p>All other arguments of the function (<code>trend</code>, <code>tau</code>, <code>serial</code>) were already discussed above except for <code>d_estim</code> and <code>d_bw</code>. These two arguments determine which estimator and bandwidth are used to estimate the order of integration in the two regimes. Concerning the estimator, the GPH (Geweke and Porter-Hudak (1983)) and the exact local Whittle estimator (Shimotsu and Phillips (2005)) can be selected. Although the exact local Whittle estimator has a lower variance, the GPH estimator is still often considered in empirical applications due to its simplicity. In our example the results of the two estimators are almost identical.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">BP_estim</span>(x, <span class="dt">direction=</span><span class="st">&quot;01&quot;</span>, <span class="dt">d_estim=</span><span class="st">&quot;GPH&quot;</span>)
<span class="co">#&gt; $Breakpoint</span>
<span class="co">#&gt; [1] 151</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $d_1</span>
<span class="co">#&gt; [1] 0.855238</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_1</span>
<span class="co">#&gt; [1] 0.129834</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $d_2</span>
<span class="co">#&gt; [1] 1.034389</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_2</span>
<span class="co">#&gt; [1] 0.1468516</span></code></pre></div>
<p>The <code>d_bw</code> argument determines how many frequencies are used for estimation. Larger values imply a lower variance of the estimates, but also bias the estimator if the underlying process possesses short run dynamics. Usually a value between 0.5 and 0.8 is considered.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">BP_estim</span>(x, <span class="dt">direction=</span><span class="st">&quot;01&quot;</span>, <span class="dt">d_bw=</span><span class="fl">0.75</span>)
<span class="co">#&gt; $Breakpoint</span>
<span class="co">#&gt; [1] 151</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $d_1</span>
<span class="co">#&gt; [1] 0.8422012</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_1</span>
<span class="co">#&gt; [1] 0.1089517</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $d_2</span>
<span class="co">#&gt; [1] 1.042382</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_2</span>
<span class="co">#&gt; [1] 0.1149333</span>
<span class="kw">BP_estim</span>(x, <span class="dt">direction=</span><span class="st">&quot;01&quot;</span>, <span class="dt">d_bw=</span><span class="fl">0.65</span>)
<span class="co">#&gt; $Breakpoint</span>
<span class="co">#&gt; [1] 151</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $d_1</span>
<span class="co">#&gt; [1] 0.5477746</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_1</span>
<span class="co">#&gt; [1] 0.089527</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $d_2</span>
<span class="co">#&gt; [1] 0.8525081</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_2</span>
<span class="co">#&gt; [1] 0.1369818</span></code></pre></div>
<p>In our setup, it can be seen that increasing <code>d_bw</code> to 0.75 does not severely change the estimated order of integration in the two regimes. Decreasing <code>d_bw</code>, however, leads to smaller estimates of <span class="math inline">\(d\)</span>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-busetti2004tests">
<p>Busetti, Fabio, and AM Robert Taylor. 2004. “Tests of Stationarity Against a Change in Persistence.” <em>Journal of Econometrics</em> 123 (1). Elsevier: 33–66. doi:<a href="https://doi.org/10.1016/j.jeconom.2003.10.028">10.1016/j.jeconom.2003.10.028</a>.</p>
</div>
<div id="ref-harvey2006modified">
<p>Harvey, David I, Stephen Leybourne, and AM Robert Taylor. 2006. “Modified Tests for a Change in Persistence.” <em>Journal of Econometrics</em> 134 (2). Elsevier: 441–69. doi:<a href="https://doi.org/10.1016/j.jeconom.2005.07.002">10.1016/j.jeconom.2005.07.002</a>.</p>
</div>
<div id="ref-kim2000detection">
<p>Kim, Jae-Young. 2000. “Detection of Change in Persistence of a Linear Time Series.” <em>Journal of Econometrics</em> 95 (1). Elsevier: 97–116. doi:<a href="https://doi.org/10.1016/S0304-4076(99)00031-7">10.1016/S0304-4076(99)00031-7</a>.</p>
</div>
<div id="ref-leybourne2004tests">
<p>Leybourne, Stephen, and AM Robert Taylor. 2004. “On Tests for Changes in Persistence.” <em>Economics Letters</em> 84 (1). Elsevier: 107–15. doi:<a href="https://doi.org/10.1016/j.econlet.2003.12.015">10.1016/j.econlet.2003.12.015</a>.</p>
</div>
<div id="ref-leybourne2003tests">
<p>Leybourne, Stephen, Tae-Hwan Kim, Vanessa Smith, and Paul Newbold. 2003. “Tests for a Change in Persistence Against the Null of Difference-Stationarity.” <em>The Econometrics Journal</em> 6 (2). Oxford University Press Oxford, UK: 291–311. doi:<a href="https://doi.org/10.1111/1368-423X.t01-1-00110">10.1111/1368-423X.t01-1-00110</a>.</p>
</div>
<div id="ref-leybourne2007cusum">
<p>Leybourne, Stephen, Robert Taylor, and Tae-Hwan Kim. 2007. “CUSUM of Squares-Based Tests for a Change in Persistence.” <em>Journal of Time Series Analysis</em> 28 (3). Wiley Online Library: 408–33. doi:<a href="https://doi.org/10.1111/j.1467-9892.2006.00517.x">10.1111/j.1467-9892.2006.00517.x</a>.</p>
</div>
<div id="ref-martins2014testing">
<p>Martins, Luis F, and Paulo MM Rodrigues. 2014. “Testing for Persistence Change in Fractionally Integrated Models: An Application to World Inflation Rates.” <em>Computational Statistics &amp; Data Analysis</em> 76. Elsevier: 502–22. doi:<a href="https://doi.org/10.1016/j.csda.2012.07.021">10.1016/j.csda.2012.07.021</a>.</p>
</div>
<div id="ref-robinson1995gaussian">
<p>Robinson, Peter M, and others. 1995. “Gaussian Semiparametric Estimation of Long Range Dependence.” <em>The Annals of Statistics</em> 23 (5). Institute of Mathematical Statistics: 1630–61. doi:<a href="https://doi.org/10.1214/aos/1176324317">10.1214/aos/1176324317</a>.</p>
</div>
<div id="ref-shimotsu2010exact">
<p>Shimotsu, Katsumi. 2010. “Exact Local Whittle Estimation of Fractional Integration with Unknown Mean and Time Trend.” <em>Econometric Theory</em> 26 (2). Cambridge University Press: 501–40. doi:<a href="https://doi.org/10.1017/S0266466609100075">10.1017/S0266466609100075</a>.</p>
</div>
<div id="ref-sibbertsen2009testing">
<p>Sibbertsen, Philipp, and Robinson Kruse. 2009. “Testing for a Break in Persistence Under Long-Range Dependencies.” <em>Journal of Time Series Analysis</em> 30 (3). Wiley Online Library: 263–85. doi:<a href="https://doi.org/10.1111/j.1467-9892.2009.00611.x">10.1111/j.1467-9892.2009.00611.x</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
